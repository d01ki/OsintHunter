{% extends "base.html" %}
{% block content %}
<section class="hero">
  <h1>結果</h1>
  <p>入力をもとにエージェントが収集・推論した内容です。</p>
</section>

{% if error %}
<div class="card" style="border:1px solid #e03b24;background:#fff3f0;">
  <h3>エラー</h3>
  <p>{{ error }}</p>
</div>
{% endif %}

<div class="grid">
  <div class="card">
    <h3>入力</h3>
    <p><strong>テキスト:</strong> {{ prompt }}</p>
    {% if urls %}<p><strong>URL:</strong> {{ urls|join(', ') }}</p>{% endif %}
    {% if images %}<p><strong>画像:</strong> {{ images|join(', ') }}</p>{% endif %}
  </div>

  <div class="card">
    <h3>プラン</h3>
    {% if result %}
      {% for step in result.plan %}
        <span class="pill-plan">{{ step.title }}</span>
      {% endfor %}
    {% else %}
      <p class="muted">未実行</p>
    {% endif %}
  </div>

  <div class="card">
    <h3>Evidence</h3>
    {% if result and result.evidence %}
      {% for ev in result.evidence %}
        <div class="evidence-item">
          <div><strong>{{ ev.source }}</strong> ({{ '%.2f'|format(ev.confidence) }})</div>
          <div>{{ ev.fact }}</div>
        </div>
      {% endfor %}
    {% else %}
      <p class="muted">なし</p>
    {% endif %}
  </div>

  <div class="card">
    <h3>Flag Candidates</h3>
    {% if result and result.flag_candidates %}
      <ul>
        {% for f in result.flag_candidates %}
          <li>{{ f }}</li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="muted">候補なし</p>
    {% endif %}
  </div>
</div>
{% endblock %}
